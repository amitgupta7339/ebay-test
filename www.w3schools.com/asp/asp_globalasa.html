
<!DOCTYPE html>
<html lang="en-US">

<!-- Mirrored from www.w3schools.com/asp/asp_globalasa.asp by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 13 Mar 2016 11:00:55 GMT -->
<head>

<title>ASP Global.asa</title>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="Keywords" content="HTML,CSS,JavaScript,SQL,PHP,jQuery,ASP,XML,DOM,Bootstrap,Web development,W3C,tutorials,programming,training,learning,quiz,primer,lessons,references,examples,source code,colors,demos,tips">
<meta name="Description" content="Well organized and easy to understand Web bulding tutorials with lots of examples of how to use HTML, CSS, JavaScript, SQL, PHP, and XML.">
<link rel="icon" href="../favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../lib/w3.css">

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','../../www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-3855518-1', 'auto');
ga('require', 'displayfeatures');
ga('send', 'pageview');
</script>

<script type='text/javascript'>
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') + 
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script>

<script type='text/javascript'>
// GPT slots
var gptAdSlots = [];
googletag.cmd.push(function() {
var leaderMapping = googletag.sizeMapping().
// Mobile ad
addSize([0, 0], [320, 50]). 
// Vertical Tablet ad
addSize([480, 0], [468, 60]). 
// Horizontal Tablet
addSize([750, 0], [728, 90]).
// Small Desktop
addSize([993, 0], [468, 60]).
// Normal Desktop
addSize([1135, 0], [728, 90]).
// Large Desktop and bigger ad
addSize([1425, 0], [[728, 90], [970, 90]]).build();
gptAdSlots[0] = googletag.defineSlot('/16833175/MainLeaderboard', [[728, 90], [970, 90]], 'div-gpt-ad-1422003450156-2').
defineSizeMapping(leaderMapping).addService(googletag.pubads());
var skyMapping = googletag.sizeMapping().
// Mobile ad
addSize([0, 0], [320, 50]). 
// Tablet ad
addSize([975, 0], [120, 600]). 
// Desktop
addSize([1135, 0], [160, 600]).   
// Large Desktop
addSize([1675, 0], [[160, 600], [300, 600], [300, 1050]]).build();
gptAdSlots[1] = googletag.defineSlot('/16833175/WideSkyScraper', [[160, 600], [300, 600], [300, 1050]], 'div-gpt-ad-1422003450156-5').
defineSizeMapping(skyMapping).addService(googletag.pubads());
var bmrMapping = googletag.sizeMapping().
// Smaller
addSize([0, 0], [[300, 250], [336, 280]]). 
// Large Desktop
addSize([1200, 0], [[300, 250], [336, 280], [970, 250]]).build();
gptAdSlots[2] = googletag.defineSlot('/16833175/BottomMediumRectangle', [[300, 250], [336, 280], [970, 250]], 'div-gpt-ad-1422003450156-0').
defineSizeMapping(bmrMapping).setCollapseEmptyDiv(true).addService(googletag.pubads());
gptAdSlots[3] = googletag.defineSlot('/16833175/RightBottomMediumRectangle', [[300, 250], [336, 280]], 'div-gpt-ad-1422003450156-3').addService(googletag.pubads());
googletag.pubads().setTargeting("content","asp");
googletag.enableServices();
});
</script>
<link rel="stylesheet" type="text/css" href="../stdtheme.css" />
</head>
<body>
<div class='w3-container top'>
<a class='w3schools-logo' href='../index.html'>w3schools<span class='dotcom'>.com</span></a>
<div class='w3-right toptext w3-wide'>THE WORLD'S LARGEST WEB DEVELOPER SITE</div></div>
<div class='w3-topnav w3-card-2 w3-slim topnav' id='topnav'>
<div style='overflow:auto;'>
<div style='float:left;width:50%;overflow:hidden;height:44px'>
<a href='javascript:void(0);' class='topnav-localicons w3-hide-large w3-left' onclick='open_menu()' title='Menu'>&#9776;</a>
<a href='../default.html' class='topnav-icons fa fa-home w3-left' title='Home'></a>
<a href='../html/default.html' class='w3-hide-small' title='HTML Tutorial'>HTML</a><a href='../css/default.html' class='w3-hide-small' title='CSS Tutorial'>CSS</a><a href='../js/default.html' class='w3-hide-small' title='JavaScript Tutorial'>JAVASCRIPT</a><a href='../sql/default.html' class='w3-hide-small' title='SQL Tutorial'>SQL</a><a href='../php/default.html' class='w3-hide-small' title='PHP Tutorial'>PHP</a><a href='../bootstrap/default.html' class='w3-hide-small' title='Bootstrap Tutorial'>BOOTSTRAP</a><a href='../jquery/default.html' class='w3-hide-small' title='jQuery Tutorial'>JQUERY</a><a href='../angular/default.html' class='w3-hide-small' title='Angular Tutorial'>ANGULAR</a><a href='../xml/default.html' class='w3-hide-small' title='XML Tutorial'>XML</a></div>
<div style='float:right;width:110px;overflow:hidden;height:44px;'>
<a href='javascript:void(0);' class='topnav-icons fa fa-search w3-right' onclick='w3_open_nav("search")' title='Search W3Schools'></a>
<a href='javascript:void(0);' class='topnav-icons fa fa-globe w3-right' onclick='openGoogleTranslate();w3_open_nav("translate")' title='Translate W3Schools'></a></div>
<div class='w3-hide-small' style='float:right;width:30%;overflow:hidden;height:44px;'>
<a id='topnavbtn_tutorials' href='javascript:void(0);' onclick='w3_open_nav("tutorials")' title='Tutorials'>TUTORIALS <i class='fa fa-caret-down'></i><i class='fa fa-caret-up' style='display:none'></i></a><a id='topnavbtn_references' href='javascript:void(0);' onclick='w3_open_nav("references")' title='References'>REFERENCES <i class='fa fa-caret-down'></i><i class='fa fa-caret-up' style='display:none'></i></a><a id='topnavbtn_examples' href='javascript:void(0);' onclick='w3_open_nav("examples")' title='Examples'>EXAMPLES <i class='fa fa-caret-down'></i><i class='fa fa-caret-up' style='display:none'></i></a><a href='http://w3schools.invisionzone.com/'>FORUM</a></div></div>
<div id='nav_tutorials' class='w3-dropnav w3-light-grey w3-card-2 w3-center'></div>
<div id='nav_references' class='w3-dropnav w3-light-grey w3-card-2 w3-center'></div>
<div id='nav_examples' class='w3-dropnav w3-light-grey w3-card-2 w3-center'></div>
<div id='nav_translate' class='w3-dropnav w3-light-grey w3-card-2 w3-center'></div>
<div id='nav_search' class='w3-dropnav w3-light-grey w3-card-2 w3-center'></div></div>
<div class='w3-row w3-light-grey' id='belowtopnav'>
<div class='w3-col w3-slim' id='leftmenu'>
<div id='leftmenuinner'>
<div class='w3-light-grey' id='leftmenuinnerinner'>
<a href='javascript:void(0)' onclick='close_menu()' class='w3-closebtn w3-hide-large w3-large' style='padding:3px 12px;'>&times;</a>
<h2 class="left"><span class="left_h2">ASP</span> Tutorial</h2>
<a target="_top" href="default.html">ASP HOME</a>
<a target="_top" href="asp_intro.html">ASP Introduction</a>
<a target="_top" href="asp_install.html">ASP Install</a>
<a target="_top" href="asp_syntax.html">ASP Syntax</a>
<a target="_top" href="asp_variables.html">ASP Variables</a>
<a target="_top" href="asp_procedures.html">ASP Procedures</a>
<a target="_top" href="asp_inputforms.html">ASP Forms</a>
<a target="_top" href="asp_cookies.html">ASP Cookies</a>
<a target="_top" href="asp_sessions.html">ASP Session</a>
<a target="_top" href="asp_applications.html">ASP Application</a>
<a target="_top" href="asp_incfiles.html">ASP #include</a>
<a target="_top" href="asp_globalasa.html">ASP Global.asa</a>
<a target="_top" href="asp_send_email.html">ASP Send e-mail</a>
<br>
<h2 class="left"><span class="left_h2">VBScript</span> Tutorial</h2>
<a target="_top" href="vbscript_default.html" >VB HOME</a>
<a target="_top" href="vbscript_variables.html">VB Variables</a>
<a target="_top" href="vbscript_procedures.html">VB Procedures</a>
<a target="_top" href="vbscript_conditionals.html">VB Conditional</a>
<a target="_top" href="vbscript_looping.html">VB Looping</a>
<a target="_top" href="vbscript_examples.html">VB Examples</a>
<a target="_top" href="vbscript_ref_functions.html">VB Functions</a>
<a target="_top" href="vbscript_ref_keywords.html">VB Keywords</a>
<br>
<h2 class="left"><span class="left_h2">ASP</span> Objects</h2>
<a target="_top" href="asp_ref_response.html">ASP Response</a>
<a target="_top" href="asp_ref_request.html">ASP Request</a>
<a target="_top" href="asp_ref_application.html">ASP Application</a>
<a target="_top" href="asp_ref_session.html">ASP Session</a>
<a target="_top" href="asp_ref_server.html">ASP Server</a>
<a target="_top" href="asp_ref_error.html">ASP Error</a>
<a target="_top" href="asp_ref_filesystem.html">ASP FileSystem</a>
<a target="_top" href="asp_ref_textstream.html">ASP TextStream</a>
<a target="_top" href="asp_ref_drive.html">ASP Drive</a>
<a target="_top" href="asp_ref_file.html">ASP File</a>
<a target="_top" href="asp_ref_folder.html">ASP Folder</a>
<a target="_top" href="asp_ref_dictionary.html">ASP Dictionary</a>
<a target="_top" href="asp_adrotator.html">ASP AdRotator</a>
<a target="_top" href="asp_browser.html">ASP BrowserCap</a>
<a target="_top" href="asp_contentlinking.html">ASP Content Linking</a>
<a target="_top" href="asp_contentrotator.html">ASP Content Rotator</a>
<a target="_top" href="asp_quickref.html">ASP Quick Ref</a>
<br>
<h2 class="left"><span class="left_h2">ADO</span> Tutorial</h2>
<a target="_top" href="ado_intro.html">ADO Intro</a>
<a target="_top" href="ado_connect.html">ADO Connect</a>
<a target="_top" href="ado_recordset.html">ADO Recordset</a>
<a target="_top" href="ado_display.html">ADO Display</a>
<a target="_top" href="ado_query.html">ADO Query</a>
<a target="_top" href="ado_sort.html">ADO Sort</a>
<a target="_top" href="ado_add.html">ADO Add</a>
<a target="_top" href="ado_update.html">ADO Update</a>
<a target="_top" href="ado_delete.html">ADO Delete</a>
<a target="_top" href="ado_demo.html">ADO Demo</a>
<a target="_top" href="ado_getstring.html">ADO Speed Up</a>
<br>
<h2 class="left"><span class="left_h2">ADO</span> Objects</h2>
<a target="_top" href="ado_ref_command.html">ADO Command</a>
<a target="_top" href="ado_ref_connection.html">ADO Connection</a>
<a target="_top" href="ado_ref_error.html">ADO Error</a>
<a target="_top" href="ado_ref_field.html">ADO Field</a>
<a target="_top" href="ado_ref_parameter.html">ADO Parameter</a>
<a target="_top" href="ado_ref_property.html">ADO Property</a>
<a target="_top" href="ado_ref_record.html">ADO Record</a>
<a target="_top" href="ado_ref_recordset.html">ADO Recordset</a>
<a target="_top" href="ado_ref_stream.html">ADO Stream</a>
<a target="_top" href="ado_datatypes.html">ADO DataTypes</a>
<br>
<h2 class="left"><span class="left_h2">ASP</span> and AJAX</h2>
<a target="_top" href="asp_ajax_intro.html">AJAX Intro</a>
<a target="_top" href="asp_ajax_asp.html">AJAX ASP</a>
<a target="_top" href="asp_ajax_database.html">AJAX Database</a>
<br>
<h2 class="left"><span class="left_h2">ASP</span> Examples</h2>
<a target="_top" href="asp_examples.html">ASP Examples</a>
<a target="_top" href="asp_quiz.html">ASP Quiz</a>
<br>
<br><br></div></div>&nbsp;</div>
<div class='w3-rest'>
<div class='w3-row w3-white'>
<div class='w3-col l10 m12' id='main'>
<div id='mainLeaderboard' style='overflow:hidden;'>
<!-- MainLeaderboard-->
<div id='div-gpt-ad-1422003450156-2'>
<script type='text/javascript'>googletag.cmd.push(function() { googletag.display('div-gpt-ad-1422003450156-2'); });</script>
</div></div>
<h1>ASP <span class="color_h1">The Global.asa file</span></h1>
<div class="chapter">
<div class="prev"><a class="chapter" href="asp_incfiles.html">&laquo; Previous</a></div>
<div class="next"><a class="chapter" href="asp_send_email.html">Next Chapter &raquo;</a></div>
</div>
<hr>
<h2>The Global.asa file</h2>
<p>The Global.asa file is an optional file that can contain declarations of objects, variables, and methods that
can be accessed by every page in an ASP application.</p>
<p>All valid browser scripts (JavaScript, VBScript, JScript, PerlScript, etc.) can be used within Global.asa.</p>

<p>The Global.asa file can contain only the following:</p>
<ul>
  <li>Application events</li>
  <li>Session events</li>
  <li>&lt;object&gt; declarations</li>
  <li>TypeLibrary declarations</li>
  <li>the #include directive</li>
</ul>

<p><b>Note:</b> The Global.asa file must be stored in the root directory of the
ASP application, and each application can only have one Global.asa file.</p>
<hr>

<h2>Events in Global.asa</h2>
<p>In  Global.asa you can tell the application and session objects what to do when the application/session starts and what to do when the
application/session ends. The code for this is placed in event handlers. The Global.asa file can contain four types of events:</p>
<b>Application_OnStart</b> - Occurs when the FIRST user calls the first page in an ASP application. This event occurs after the
Web server is restarted or after the Global.asa file is edited. The &quot;Session_OnStart&quot; event occurs immediately after this event.
<p><b>Session_OnStart</b> - This event occurs EVERY time a NEW user requests his or her first page in the ASP application.</p>
<p><b>Session_OnEnd</b> - This event occurs EVERY time a user ends a session. A user-session ends after a page has not been requested by the user for a 
specified time (by default this is 20 minutes).</p>
<p><b>Application_OnEnd</b> - This event occurs after the LAST user has ended the session. Typically, this event occurs when a Web server stops.
This procedure is used to clean up settings after the Application stops, like delete records or write information to text files.</p>
<p>A Global.asa file could look something like this:</p>

<div class="w3-code w3-border notranslate"><div>

&lt;script language=&quot;vbscript&quot; runat=&quot;server&quot;&gt;<br><br>
sub Application_OnStart<br>
  '<i>some code</i><br>
end sub<br><br>
sub Application_OnEnd<br>
  '<i>some code</i><br>
end sub<br><br>
sub Session_OnStart<br>
  '<i>some code</i><br>
end sub<br><br>
sub Session_OnEnd<br>
  '<i>some code</i><br>
end sub<br><br>
&lt;/script&gt;</div></div>

<p><b>Note:</b> Because we cannot use the ASP script delimiters (&lt;% and %&gt;) to insert scripts in the Global.asa file, we put subroutines inside an HTML 
&lt;script&gt; element.</p>
<hr>

<h2>&lt;object&gt; Declarations</h2>
<p>It is possible to create objects with session or application scope in Global.asa by using the &lt;object&gt; tag.</p>
<p><b>Note:</b> The &lt;object&gt; tag should be outside the &lt;script&gt; tag!</p>

<h3>Syntax</h3>

<div class="w3-code w3-border notranslate"><div>

&lt;object runat=&quot;server&quot; scope=&quot;<i>scope</i>&quot; id=&quot;<i>id</i>&quot;
{progid=&quot;<i>progID</i>&quot;|classid=&quot;<i>classID</i>&quot;}&gt;<br>
....<br>
&lt;/object&gt;</div></div>

<br>
<table class="w3-table-all notranslate">
  <tr>
    <th style="width:20%">Parameter</th>
    <th>Description</th>
  </tr>  
  <tr>
    <td>scope </td>
    <td>Sets the scope of the object (either Session or Application)</td>
  </tr>
  <tr>
    <td>id </td>
    <td>Specifies a unique id for the object</td>
  </tr>
  <tr>
    <td>ProgID </td>
    <td>An id associated with a class id. The format for ProgID is [Vendor.]Component[.Version]
    <p> Either ProgID or ClassID must be specified.</p></td>
  </tr>
  <tr>
    <td>ClassID </td>
    <td>Specifies a unique id for a COM class object.<p> Either ProgID or ClassID must be specified.</p></td>
  </tr>
</table>

<h3>Examples</h3>
<p>The first example creates an object of session scope named &quot;MyAd&quot; by using the ProgID parameter:</p>

<div class="w3-code w3-border notranslate"><div>
&lt;object runat=&quot;server&quot; scope=&quot;session&quot; id=&quot;MyAd&quot;
progid=&quot;MSWC.AdRotator&quot;&gt;<br>
&lt;/object&gt;</div></div>

<p>The second example creates an object of application scope named &quot;MyConnection&quot; by using the ClassID parameter:</p>

<div class="w3-code w3-border notranslate"><div>

&lt;object runat=&quot;server&quot; scope=&quot;application&quot; id=&quot;MyConnection&quot;<br>
classid=&quot;Clsid:8AD3067A-B3FC-11CF-A560-00A0C9081C21&quot;&gt;<br>
&lt;/object&gt;</div></div>

<p>The objects declared in the Global.asa file can be used by any script in the application:</p>

<div class="w3-code w3-border notranslate"><div>

GLOBAL.ASA:<br><br>
&lt;object runat=&quot;server&quot; scope=&quot;session&quot; id=&quot;MyAd&quot;
progid=&quot;MSWC.AdRotator&quot;&gt;<br>
&lt;/object&gt;<br><br>
You could reference the object &quot;MyAd&quot; from any page in the ASP application:<br><br>
SOME .ASP FILE:<br><br>
&lt;%=MyAd.GetAdvertisement(&quot;/banners/adrot.txt&quot;)%&gt;</div></div>
<hr>

<h2>TypeLibrary Declarations</h2>
<p>A TypeLibrary is a container for the contents of a DLL file corresponding to a COM object. By including a call to the TypeLibrary in the Global.asa file,
the constants of the COM object can be accessed, and errors can be better reported by the ASP code. If your Web application relies on COM objects that have
declared data types in type libraries, you can declare the type libraries in Global.asa.</p>

<h3>Syntax</h3>

<div class="w3-code w3-border notranslate"><div>

&lt;!--METADATA TYPE=&quot;TypeLib&quot;<br>
file=&quot;<i>filename</i>&quot;
uuid=&quot;<i>id</i>&quot;
version=&quot;<i>number</i>&quot;
lcid=&quot;<i>localeid</i>&quot;<br>
--&gt;</div></div>
<br>

<table class="w3-table-all notranslate">
  <tr>
    <th style="width:20%">Parameter</th>
    <th>Description</th>
  </tr>  
  <tr>
    <td>file</td>
    <td>Specifies an absolute path to a type library.
      <p>Either the file parameter or the uuid parameter is required</p></td>
  </tr>
  <tr>
    <td>uuid</td>
    <td>Specifies a unique identifier for the type library.
      <p>Either the file parameter or the uuid parameter is required</p></td>
  </tr>
  <tr>
    <td>version</td>
    <td>Optional. Used for selecting version. If the requested version is not found, then the most recent version is used</td>
  </tr>
  <tr>
    <td>lcid</td>
    <td>Optional. The locale identifier to be used for the type library</td>
  </tr>
</table>

<h3>Error Values</h3>

<p>The server can return one of the following error messages:</p>

<table class="w3-table-all notranslate">
  <tr>
    <th style="width:20%">Error Code</th>
    <th>Description</th>
  </tr>  
  <tr>
    <td>ASP 0222</td>
    <td> Invalid type library specification</td>
  </tr>
  <tr>
    <td>ASP 0223</td>
    <td> Type library not found</td>
  </tr>
  <tr>
    <td>ASP 0224</td>
    <td> Type library cannot be loaded</td>
  </tr>
  <tr>
    <td>ASP 0225</td>
    <td> Type library cannot be wrapped</td>
  </tr>
</table>

<p><b>Note:</b> METADATA tags can appear anywhere in the Global.asa file (both inside and outside &lt;script&gt; tags). However, it is recommended that
METADATA tags appear near the top of the Global.asa file.</p>
<hr>

<h2>Restrictions</h2>
<p>Restrictions on what you can include in the Global.asa file:</p>
<ul>
  <li> You cannot display text written in the Global.asa file. This file can't display information</li>
  <li>You can only use Server and Application objects in the Application_OnStart and Application_OnEnd
subroutines. In the&nbsp;Session_OnEnd subroutine, you can use Server, Application, and Session
    objects. In the Session_OnStart subroutine you can use any built-in object</li>
</ul>
<hr>

<h2>How to use the Subroutines</h2>
<p>Global.asa is often used to initialize variables.&nbsp;</p>
<p> The example below shows how to detect the exact time a visitor first arrives on a Web site. The time is stored in a Session variable named 
&quot;started&quot;, and the value of the &quot;started&quot; variable can be accessed from any ASP page in the application:</p>

<div class="w3-code w3-border notranslate"><div>

&lt;script language=&quot;vbscript&quot; runat=&quot;server&quot;&gt;<br>
sub Session_OnStart<br>
Session(&quot;started&quot;)=now()<br>
end sub<br>
&lt;/script&gt;</div></div>

<p>Global.asa can also be used to control page access.</p>

<p>The example below shows how to redirect every new visitor to another page, in this case to a
page called &quot;newpage.asp&quot;:</p>

<div class="w3-code w3-border notranslate"><div>

&lt;script language=&quot;vbscript&quot; runat=&quot;server&quot;&gt;<br>
sub Session_OnStart<br>
Response.Redirect(&quot;newpage.asp&quot;)<br>
end sub<br>
&lt;/script&gt;</div></div>

<p>And you can include functions in the Global.asa file.</p>
<p>In the example below the Application_OnStart subroutine occurs when the Web server starts. Then
the Application_OnStart subroutine calls another subroutine named &quot;getcustomers&quot;.
The &quot;getcustomers&quot; subroutine opens a database and retrieves a record set from
the &quot;customers&quot; table. The record set is assigned to an array, where it
can be accessed from any ASP page without querying the database:</p>

<div class="w3-code w3-border notranslate"><div>

&lt;script language=&quot;vbscript&quot; runat=&quot;server&quot;&gt;<br><br>
sub Application_OnStart<br>
getcustomers<br>
end sub<br><br>
sub getcustomers<br>
set conn=Server.CreateObject(&quot;ADODB.Connection&quot;)<br>
conn.Provider=&quot;Microsoft.Jet.OLEDB.4.0&quot;<br>
conn.Open &quot;c:/webdata/northwind.mdb&quot;<br>
set rs=conn.execute(&quot;select name from customers&quot;)<br>
Application(&quot;customers&quot;)=rs.GetRows<br>
rs.Close<br>
conn.Close<br>
end sub<br><br>
&lt;/script&gt;</div></div>
<hr>

<h2>Global.asa Example</h2>
<p>In this example we will create a Global.asa file that counts the number of current visitors.</p>
<ul>
  <li>The Application_OnStart sets the Application variable &quot;visitors&quot; to 0 when the server starts</li>
  <li>The Session_OnStart subroutine adds one to the variable &quot;visitors&quot; every time a new visitor arrives</li>
  <li>The Session_OnEnd subroutine subtracts one from &quot;visitors&quot; each time this subroutine is triggered</li>
</ul>
<p>The Global.asa file:</p>

<div class="w3-code w3-border notranslate"><div>

&lt;script language=&quot;vbscript&quot; runat=&quot;server&quot;&gt;<br><br>
Sub Application_OnStart<br>
Application(&quot;visitors&quot;)=0<br>
End Sub<br><br>
Sub Session_OnStart<br>
Application.Lock<br>
Application(&quot;visitors&quot;)=Application(&quot;visitors&quot;)+1<br>
Application.UnLock<br>
End Sub<br><br>
Sub Session_OnEnd<br>
Application.Lock<br>
Application(&quot;visitors&quot;)=Application(&quot;visitors&quot;)-1<br>
Application.UnLock<br>
End Sub<br><br>
&lt;/script&gt;</div></div>

<p>To display the number of current visitors in an ASP file:</p>

<div class="w3-code w3-border notranslate"><div>

	&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;/head&gt;<br>
&lt;body&gt;<br>
&lt;p&gt;There are &lt;%response.write(Application(&quot;visitors&quot;))%&gt;
online now!&lt;/p&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;</div></div>
<br>
<div class="chapter">
<div class="prev"><a class="chapter" href="asp_incfiles.html">&laquo; Previous</a></div>
<div class="next"><a class="chapter" href="asp_send_email.html">Next Chapter &raquo;</a></div>
</div>
</div>
<div class="w3-col l2 m12" id="right">

<div class="sidesection">
<div id="skyscraper">
<div id="div-gpt-ad-1422003450156-5">
<script>
 googletag.cmd.push(function() {
 googletag.display('div-gpt-ad-1422003450156-5');
 });
 </script> 
</div>
</div>
</div>

<div class="sidesection">
<h3>W3SCHOOLS EXAMS</h3>
<a target="_blank" href="../cert/default.html">HTML, CSS, JavaScript, PHP, jQuery, and XML Certifications</a>
</div>

<div class="sidesection">
<h3>COLOR PICKER</h3>
<a href="../colors/colors_picker.html">
<img src="../images/colorpicker.gif" alt="colorpicker"></a>
</div>

<div class="sidesection">
<h3>SHARE THIS PAGE</h3>
<div class="w3-text-grey sharethis">
<script>
<!--
try{
loc=location.pathname;
if (loc.toUpperCase().indexOf(".ASP")<0) loc=loc+"default.asp";
txt='<a href="http://www.facebook.com/sharer.php?u=http://www.w3schools.com'+loc+'" target="_blank" title="Facebook"><span class="fa fa-facebook-square fa-2x"></span></a>';
txt=txt+'<a href="http://twitter.com/home?status=Currently reading http://www.w3schools.com'+loc+'" target="_blank" title="Twitter"><span class="fa fa-twitter-square fa-2x"></span></a>';
txt=txt+'<a href="https://plus.google.com/share?url=http://www.w3schools.com'+loc+'" target="_blank" title="Google+"><span class="fa fa-google-plus-square fa-2x"></span></a>';
document.write(txt);
} catch(e) {}
//-->
</script>
</div>
</div>

<div class="sidesection w3-text-grey sharethis">
<a href="javascript:void(0);" onclick="clickFBLike()" title="Like W3Schools on Facebook">
<span class="fa fa-thumbs-o-up fa-2x"></span></a>
<div id="fblikeframe">
<div id="popupframe"></div>
<div id="popupDIV"></div>
</div>
</div>       

<div class="sidesection">
<h3>LEARN MORE:</h3>
<p>
<a href="../colors/colors_converter.html">Color Converter</a><br>
<a href="../howto/howto_google_maps.html">Google Maps</a><br>
<a href="../howto/howto_css_animate_buttons.html">Animated Buttons</a><br>
<a href="../howto/howto_css_modals.html">Modal Boxes</a><br>
<a href="../howto/howto_css_modal_images.html">Modal Images</a><br>
<a href="../howto/howto_css_tooltip.html">Tooltips</a><br>
<a href="../howto/howto_css_loader.html">Loaders</a><br>
<a href="../howto/howto_js_animate.html">JS Animations</a><br>
<a href="../howto/howto_js_progressbar.html">Progress Bars</a><br>
<a href="../howto/howto_js_dropdown.html">Dropdowns</a><br>
<a href="../howto/howto_js_slideshow.html">Slideshow</a><br>
<a href="../howto/howto_js_sidenav.html">Side Navigation</a><br>
<a href="../howto/howto_html_include.html">HTML Includes</a><br>
<a href="../w3css/w3css_color_palettes.html">Color Palettes</a>
</p>
</div>

</div>
</div>
<div class="footer w3-container w3-white">      

<hr>
<div style="overflow:auto">
<!-- BottomMediumRectangle -->
<div class="bottomad" id='div-gpt-ad-1422003450156-0'>
<script type='text/javascript'>
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1422003450156-0'); });
</script>
</div>
<!-- RightBottomMediumRectangle -->
<div class="bottomad" id='div-gpt-ad-1422003450156-3'>
<script type='text/javascript'>
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1422003450156-3'); });
</script>
</div>
</div>

<hr>
<div class="w3-row w3-center w3-small">
<div class="w3-col l3 m3 s12">
<a href="javascript:void(0);" onclick="displayError();return false" style="white-space:nowrap;">REPORT ERROR</a>
</div>
<div class="w3-col l3 m3 s12">
<a href="#" target="_blank" onclick="printPage();return false;">PRINT PAGE</a>
</div>
<div class="w3-col l3 m3 s12">
<a href="http://w3schools.invisionzone.com/" target="_blank">FORUM</a>
</div>
<div class="w3-col l3 m3 s12">
<a href="../about/default.html" target="_top">ABOUT</a>
</div>
</div>
<hr>
<div class="w3-light-grey w3-padding w3-center" id="err_form" style="display:none;">
<span onclick="this.parentElement.style.display='none'" class="w3-closebtn">&times;</span>     
<h2>Your Suggestion:</h2>
<form>
<div class="w3-group">      
<label for="err_email">Your E-mail:</label>
<input class="w3-input" type="text" style="width:100%" id="err_email" name="err_email">
</div>
<div class="w3-group">      
<label for="err_email">Page address:</label>
<input class="w3-input" type="text" style="width:100%" id="err_url" name="err_url" disabled="disabled">
</div>
<div class="w3-group">
<label for="err_email">Description:</label>
<textarea rows="10" class="w3-input" id="err_desc" name="err_desc" style="width:100%;"></textarea>
</div>
<div class="form-group">        
<button type="button" onclick="sendErr()">Submit</button>
</div>
<br>
</form>
</div>
<div class="w3-container w3-light-grey w3-padding" id="err_sent" style="display:none;">
<span onclick="this.parentElement.style.display='none'" class="w3-closebtn">&times;</span>     
<h2>Thank You For Helping Us!</h2>
<p>Your message has been sent to W3Schools.</p>
</div>

<div class="w3-row w3-center w3-small">
<div class="w3-col l3 m6 s12">
<div class="top10">
<h4>Top 10 Tutorials</h4>
<a href="../html/default.html">HTML Tutorial</a><br>
<a href="../css/default.html">CSS Tutorial</a><br>
<a href="../js/default.html">JavaScript Tutorial</a><br>
<a href="../w3css/default.html">W3.CSS Tutorial</a><br>
<a href="../bootstrap/default.html">Bootstrap Tutorial</a><br>
<a href="../sql/default.html">SQL Tutorial</a><br>
<a href="../php/default.html">PHP Tutorial</a><br>
<a href="../jquery/default.html">jQuery Tutorial</a><br>
<a href="../angular/default.html">Angular Tutorial</a><br>
<a href="../xml/default.html">XML Tutorial</a><br>
</div>
</div>
<div class="w3-col l3 m6 s12">
<div class="top10">
<h4>Top 10 References</h4>
<a href="../tags/default.html">HTML Reference</a><br>
<a href="../cssref/default.html">CSS Reference</a><br>
<a href="../jsref/default.html">JavaScript Reference</a><br>
<a href="../w3css/w3css_references.html">W3.CSS Reference</a><br>
<a href="../browsers/default.html">Browser Statistics</a><br>
<a href="../php/php_ref_array.asp">PHP Reference</a><br>
<a href="../colors/colors_names.html">HTML Colors</a><br>
<a href="../charsets/default.html">HTML Character Sets</a><br>
<a href="../jquery/jquery_ref_selectors.html">jQuery Reference</a><br>
<a href="../angular/angular_ref_directives.html">AngularJS Reference</a><br>
</div>
</div>
<div class="w3-col l3 m6 s12">
<div class="top10">
<h4>Top 10 Examples</h4>
<a href="../html/html_examples.html">HTML Examples</a><br>
<a href="../css/css_examples.html">CSS Examples</a><br>
<a href="../js/js_examples.html">JavaScript Examples</a><br>
<a href="../w3css/w3css_examples.html">W3.CSS Examples</a><br>
<a href="../js/js_dom_examples.html">HTML DOM Examples</a><br>
<a href="../php/php_examples.html">PHP Examples</a><br>
<a href="../jquery/jquery_examples.html">jQuery Examples</a><br>
<a href="asp_examples.html">ASP Examples</a><br>
<a href="../xml/xml_examples.html">XML Examples</a><br>
<a href="../svg/svg_examples.html">SVG Examples</a>
</div>
</div>
<div class="w3-col l3 m6 s12">
<div class="top10">
<h4>Web Certificates</h4>
<a href="../cert/default.html">HTML Certificate</a><br>
<a href="../cert/default.html">HTML5 Certificate</a><br>
<a href="../cert/default.html">CSS Certificate</a><br>
<a href="../cert/default.html">JavaScript Certificate</a><br>
<a href="../cert/default.html">jQuery Certificate</a><br>
<a href="../cert/default.html">PHP Certificate</a><br>
<a href="../cert/default.html">Bootstrap Certificate</a><br>
<a href="../cert/default.html">XML Certificate</a><br>
</div>
</div>        
</div>        

<hr>
<div class="w3-center w3-small w3-opacity">
W3Schools is optimized for learning, testing, and training. Examples might be simplified to improve reading and basic understanding.
Tutorials, references, and examples are constantly reviewed to avoid errors, but we cannot warrant full correctness of all content.
While using this site, you agree to have read and accepted our <a href="../about/about_copyright.html">terms of use</a>,
<a href="../about/about_privacy.html">cookie and privacy policy</a>.
<a href="../about/about_copyright.html">Copyright 1999-2016</a> by Refsnes Data. All Rights Reserved.<br><br>
<a href="../index.html">
<img style="width:150px;height:28px;border:0" src="../images/w3schoolscom_gray.gif" alt="W3Schools.com"></a>
</div>
<br><br>
</div>
</div>
</div>

<div id="nav_tutorials_content" style="display:none;">
<span onclick='w3_close_nav("tutorials")' class='w3-closebtn w3-xlarge'>&times;</span>
<div class='w3-row-padding'>
<div class='w3-col l2 m4'>
<h3>HTML/CSS</h3>
<a href='../html/default.html'>Learn HTML</a>
<a href='../css/default.html'>Learn CSS</a>
<a href='../w3css/default.html'>Learn W3.CSS</a>
<a href='../colors/default.html'>Learn Colors</a>
<a href='../bootstrap/default.html'>Learn Bootstrap</a>
</div>
<div class='w3-col l2 m4'>  
<h3>JavaScript</h3>
<a href='../js/default.html'>Learn JavaScript</a>
<a href='../jquery/default.html'>Learn jQuery</a>
<a href='../jquerymobile/default.html'>Learn jQueryMobile</a>
<a href='../appml/default.html'>Learn AppML</a>
<a href='../angular/default.html'>Learn AngularJS</a>
<a href='../ajax/default.html'>Learn AJAX</a>
<a href='../json/default.html'>Learn JSON</a>
</div>
<div class='w3-col l2 m4'>   
<h3>HTML Graphics</h3>
<a href='../canvas/default.html'>Learn Canvas</a>
<a href='../svg/default.html'>Learn SVG</a>
<a href='../icons/default.html'>Learn Icons</a>
<a href='../googleapi/default.html'>Learn Google Maps</a>
<a href="../games/default.html">Learn HTML Games</a>
</div>
<div class='w3-col l2 m4'>
<h3>Server Side</h3>
<a href='../sql/default.html'>Learn SQL</a>
<a href='../php/default.html'>Learn PHP</a>
<a href='default.html'>Learn ASP</a>
<a href='../aspnet/default.html'>Learn ASP.NET</a>
</div>
<div class='w3-col l2 m4'>
<h3>Web Building</h3>
<a href='../website/default.html'>Web Building</a>
<a href='../browsers/default.html'>Web Statistics</a>
<a href='../cert/default.html'>Web Certificates</a>
</div>
<div class='w3-col l2 m4'>
<h3>XML Tutorials</h3>
<a href='../xml/default.html'>Learn XML</a>
<a href='../xsl/default.html'>Learn XSLT</a>
</div>
</div>
</div>
<div id="nav_references_content" style="display:none;">
<span onclick='w3_close_nav("references")' class='w3-closebtn w3-xlarge'>&times;</span>
<div class='w3-row-padding'>
<div class='w3-col l2 m4'>
<h3>HTML</h3>
<a href='../tags/default.html'>HTML Tag Reference</a>
<a href='../tags/ref_eventattributes.html'>HTML Event Reference</a>
<a href='../colors/default.html'>HTML Color Reference</a>
</div>
<div class='w3-col l2 m4'>
<h3>CSS</h3>
<a href='../cssref/default.html'>CSS Reference</a>
<a href='../cssref/css_selectors.html'>CSS Selector Reference</a>
<a href='../w3css/w3css_references.html'>W3.CSS Reference</a>
<a href='../bootstrap/bootstrap_ref_css_text.html'>Bootstrap Reference</a>
</div>
<div class='w3-col l2 m4'>
<h3>JavaScript</h3>
<a href='../jsref/default.html'>JavaScript Reference</a>
<a href='../jsref/default.html'>HTML DOM Reference</a>
<a href='../jquery/jquery_ref_selectors.html'>jQuery Reference</a>
<a href='../jquerymobile/jquerymobile_ref_data.html'>jQuery Mobile Reference</a>
<a href='../angular/angular_ref_directives.html'>AngularJS Reference</a>
<a href='../googleAPI/google_maps_ref.html'>Google Maps Reference</a>
</div>
<div class='w3-col l2 m4'>
<h3>Server Side</h3>
<a href='../php/php_ref_array.asp'>PHP Reference</a>
<a href='../sql/sql_quickref.html'>SQL Reference</a>
<a href='asp_ref_response.html'>ASP Reference</a>
<a href='../aspnet/webpages_ref_classes.html'>Razor Reference</a>
<a href='../aspnet/aspnet_intro.html'>ASP.NET Reference</a>
</div>
<div class='w3-col l2 m4'>
<h3>XML</h3>
<a href='../xml/dom_nodetype.html'>XML Reference</a>
<a href='../xsl/xsl_w3celementref.html'>XSLT Reference</a>
<a href='../xml/schema_elements_ref.html'>XML Schema Reference</a>
<a href='../svg/svg_reference.html'>SVG Reference</a>
</div>
<div class='w3-col l2 m4'>
<h3>Charsets</h3>
<a href='../charsets/default.html'>HTML Character Sets</a>
<a href='../charsets/ref_html_ascii.html'>HTML ASCII</a>
<a href='../charsets/ref_html_ansi.html'>HTML ANSI</a>
<a href='../charsets/ref_html_ansi.html'>HTML Windows-1252</a>
<a href='../charsets/ref_html_8859.html'>HTML ISO-8859-1</a>
<a href='../charsets/ref_html_symbols.html'>HTML Symbols</a>
<a href='../charsets/ref_html_utf8.html'>HTML UTF-8</a>
</div>
</div>
</div>
<div id="nav_examples_content" style="display:none;">
<span onclick='w3_close_nav("examples")' class='w3-closebtn w3-xlarge'>&times;</span>
<div class='w3-row-padding'>
<div class='w3-col l3 m6'>
<h3>HTML/CSS</h3>
<a href='../html/html_examples.html'>HTML Examples</a>
<a href='../css/css_examples.html'>CSS Examples</a>
<a href='../w3css/w3css_examples.html'>W3.CSS Examples</a>
</div>
<div class='w3-col l3 m6'>
<h3>JavaScript</h3>
<a href='../js/js_examples.html' target='_top'>JavaScript Examples</a>
<a href='../js/js_dom_examples.html' target='_top'>HTML DOM Examples</a>
<a href='../jquery/jquery_examples.html' target='_top'>jQuery Examples</a>
<a href='../jquerymobile/jquerymobile_examples.html' target='_top'>jQuery Mobile Examples</a>
<a href='../angular/angular_examples.html' target='_top'>AngularJS Examples</a>
<a href='../ajax/ajax_examples.html' target='_top'>AJAX Examples</a>
</div>
<div class='w3-col l3 m6'>
<h3>Server Side</h3>
<a href='../php/php_examples.html' target='_top'>PHP Examples</a>
<a href='asp_examples.html' target='_top'>ASP Examples</a>
<a href='../aspnet/webpages_examples.html' target='_top'>Razor Examples</a>
<a href='../aspnet/aspnet_examples.html' target='_top'>.NET Examples</a>
</div>
<div class='w3-col l3 m6'>
<h3>XML</h3>
<a href='../xml/xml_examples.html' target='_top'>XML Examples</a>
<a href='../xsl/xsl_examples.html' target='_top'>XSL Examples</a>
<a href='../xsl/xsl_examples.html' target='_top'>XSLT Examples</a>
<a href='../xsl/xpath_examples.html' target='_top'>XPath Examples</a>
<a href='../xml/schema_example.html' target='_top'>XML Schema Examples</a>
<a href='../svg/svg_examples.html' target='_top'>SVG Examples</a>
</div>
</div>
</div>
<div id='nav_translate_content' style="display:none">
<span onclick='w3_close_nav("translate")' class='w3-closebtn w3-xlarge'>&times;</span>
<br><br>Translate w3schools.com:
<div id='google_translate_element'></div>
<br>
</div>
<div id='nav_search_content' style="display:none">
<span onclick='w3_close_nav("search")' class='w3-closebtn w3-xlarge'>&times;</span>
<br><br>
<div class='searchdiv'>
Search w3schools.com:
<div id='googleSearch'><div class='gcse-search'></div></div>
</div>
<br>
</div>
<script src="../lib/w3schools_footer.js"></script>
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>  
<![endif]-->
</body>

<!-- Mirrored from www.w3schools.com/asp/asp_globalasa.asp by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 13 Mar 2016 11:00:55 GMT -->
</html>
